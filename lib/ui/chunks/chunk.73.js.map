{"version":3,"sources":["webpack:///./src/ui/src/components/OfficeEditorMarginsModal/OfficeEditorMarginsModal.scss?2ee0","webpack:///./src/ui/src/components/OfficeEditorMarginsModal/OfficeEditorMarginsModal.scss","webpack:///./src/ui/src/helpers/mapObjectKeys.js","webpack:///./src/ui/src/components/OfficeEditorMarginsModal/OfficeEditorMarginsModal.js","webpack:///./src/ui/src/components/OfficeEditorMarginsModal/index.js"],"names":["api","content","__esModule","default","module","i","options","styleTag","window","isApryseWebViewerWebComponent","document","head","appendChild","webComponents","getElementsByTagName","length","findNestedWebComponents","tagName","root","elements","querySelectorAll","forEach","el","push","shadowRoot","clonedStyleTags","webComponent","onload","styleNode","innerHTML","cloneNode","exports","locals","keys","fn","reduce","acc","key","SIDES","MARGIN_SIDES","LEFT","RIGHT","TOP","BOTTOM","OfficeEditorMarginsModal","t","useTranslation","dispatch","useDispatch","currentUnit","useSelector","selectors","getOfficeEditorUnitMeasurement","useState","initialUnit","setInitialUnit","left","right","top","bottom","initialMargins","setInitialMargins","numericMargins","setNumericMargins","inputMargins","setInputMargins","maxMargins","setMaxMargins","pageWidth","setPageWidth","pageHeight","setPageHeight","areMarginsEqual","a","b","every","side","calculateMaxHorizontalMargins","oppositeMarginWidth","unit","getMinimumColumnWidth","calculateAllMaxMargins","margins","maxTopAndBottom","VERTICAL_MARGIN_LIMIT","onApply","closeModalAndFocus","core","getOfficeEditor","setSectionMargins","closeModal","console","error","showPageLayoutWarning","actions","PAGE_LAYOUT_WARNING_TYPE","MARGIN","closeElement","DataElements","OFFICE_EDITOR_MARGINS_MODAL","focusContent","inputElements","map","id","label","OFFICE_EDITOR_TRANSLATION_PREFIX","value","onChange","e","previous","handleChange","target","onBlur","maxMargin","validated","validateMarginInput","toString","handleBlur","valueAsNumber","useEffect","getEditingPageNumber","pageNumber","getSectionMargins","pageWidthInInch","getPageWidth","PIXELS_PER_INCH","pageHeightInInch","getPageHeight","pageWidthInCurrentUnit","convertMeasurementUnit","MARGIN_UNITS","INCH","pageHeightInCurrentUnit","mapObjectKeys","formatToDecimalString","setInitialData","initialMarginsInCurrentUnit","marginsInCurrentUnit","maxMarginsInCurrentUnit","validatedMargins","className","data-element","ModalWrapper","title","closehandler","onCloseClick","swipeToClose","isOpen","Dropdown","dataElement","OFFICE_EDITOR_MARGIN_UNIT","labelledById","items","Object","values","onClickItem","setOfficeEditorUnitMeasurement","getKey","item","currentSelectionKey","width","input","htmlFor","Input","type","min","step","Button","onClick"],"mappings":"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","file":"chunks/chunk.73.js","sourcesContent":["var api = require(\"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../node_modules/sass-loader/dist/cjs.js!./OfficeEditorMarginsModal.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                function findNestedWebComponents(tagName, root = document) {\n                  const elements = [];\n\n                  // Check direct children\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\n\n                  // Check shadow DOMs\n                  root.querySelectorAll('*').forEach(el => {\n                    if (el.shadowRoot) {\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\n                    }\n                  });\n\n                  return elements;\n                }\n                if (!window.isApryseWebViewerWebComponent) {\n                  document.head.appendChild(styleTag);\n                  return;\n                }\n\n                let webComponents;\n                // First we see if the webcomponent is at the document level\n                webComponents = document.getElementsByTagName('apryse-webviewer');\n                // If not, we check have to check if it is nested in another webcomponent\n                if (!webComponents.length) {\n                  webComponents = findNestedWebComponents('apryse-webviewer');\n                }\n                // Now we append the style tag to each webcomponent\n                const clonedStyleTags = [];\n                for (let i = 0; i < webComponents.length; i++) {\n                  const webComponent = webComponents[i];\n                  if (i === 0) {\n                    webComponent.shadowRoot.appendChild(styleTag);\n                    styleTag.onload = function () {\n                      if (clonedStyleTags.length > 0) {\n                        clonedStyleTags.forEach((styleNode) => {\n                          // eslint-disable-next-line no-unsanitized/property\n                          styleNode.innerHTML = styleTag.innerHTML;\n                        });\n                      }\n                    };\n                  } else {\n                    const styleNode = styleTag.cloneNode(true);\n                    webComponent.shadowRoot.appendChild(styleNode);\n                    clonedStyleTags.push(styleNode);\n                  }\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".open.OfficeEditorMarginsModal{visibility:visible}.closed.OfficeEditorMarginsModal{visibility:hidden}:host{display:inline-block;container-type:inline-size;width:100%;height:100%;overflow:hidden}@media(min-width:901px){.App:not(.is-web-component) .hide-in-desktop{display:none}}@container (min-width: 901px){.hide-in-desktop{display:none}}@media(min-width:641px)and (max-width:900px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .hide-in-tablet{display:none}}@container (min-width: 641px) and (max-width: 900px){.App.is-web-component:not(.is-in-desktop-only-mode) .hide-in-tablet{display:none}}@media(max-width:640px)and (min-width:431px){.App:not(.is-web-component) .hide-in-mobile{display:none}}@container (max-width: 640px) and (min-width: 431px){.App.is-web-component .hide-in-mobile{display:none}}@media(max-width:430px){.App:not(.is-web-component) .hide-in-small-mobile{display:none}}@container (max-width: 430px){.App.is-web-component .hide-in-small-mobile{display:none}}.always-hide{display:none}.OfficeEditorMarginsModal .footer .modal-button.confirm:hover{background:var(--primary-button-hover);border-color:var(--primary-button-hover);color:var(--gray-0)}.OfficeEditorMarginsModal .footer .modal-button.confirm{background:var(--primary-button);border-color:var(--primary-button);color:var(--primary-button-text)}.OfficeEditorMarginsModal .footer .modal-button.confirm.disabled{cursor:default;background:var(--disabled-button-color);color:var(--primary-button-text)}.OfficeEditorMarginsModal .footer .modal-button.confirm.disabled span{color:var(--primary-button-text)}.OfficeEditorMarginsModal .footer .modal-button.cancel:hover,.OfficeEditorMarginsModal .footer .modal-button.secondary-btn-custom:hover{border:none;box-shadow:inset 0 0 0 1px var(--blue-6);color:var(--blue-6)}.OfficeEditorMarginsModal .footer .modal-button.cancel,.OfficeEditorMarginsModal .footer .modal-button.secondary-btn-custom{border:none;box-shadow:inset 0 0 0 1px var(--primary-button);color:var(--primary-button)}.OfficeEditorMarginsModal .footer .modal-button.cancel.disabled,.OfficeEditorMarginsModal .footer .modal-button.secondary-btn-custom.disabled{cursor:default;border:none;box-shadow:inset 0 0 0 1px rgba(43,115,171,.5);color:rgba(43,115,171,.5)}.OfficeEditorMarginsModal .footer .modal-button.cancel.disabled span,.OfficeEditorMarginsModal .footer .modal-button.secondary-btn-custom.disabled span{color:rgba(43,115,171,.5)}.OfficeEditorMarginsModal{position:fixed;left:0;bottom:0;z-index:100;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:var(--modal-negative-space)}.OfficeEditorMarginsModal .modal-container .wrapper .modal-content{padding:10px}.OfficeEditorMarginsModal .footer{flex-direction:row;width:100%;margin-top:13px}.OfficeEditorMarginsModal .footer.modal-footer{padding:16px;margin:0;border-top:1px solid var(--divider)}.OfficeEditorMarginsModal .footer .modal-button{display:flex;justify-content:center;align-items:center;padding:6px 18px;margin:8px 0 0;width:auto;width:-moz-fit-content;width:fit-content;border-radius:4px;height:30px;cursor:pointer}.OfficeEditorMarginsModal .footer .modal-button.confirm{margin-left:4px}.OfficeEditorMarginsModal .footer .modal-button.secondary-btn-custom{border-radius:4px;padding:2px 20px 4px;cursor:pointer}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .OfficeEditorMarginsModal .footer .modal-button{padding:23px 8px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .OfficeEditorMarginsModal .footer .modal-button{padding:23px 8px}}.OfficeEditorMarginsModal .swipe-indicator{background:var(--swipe-indicator-bg);border-radius:2px;height:4px;width:38px;position:absolute;top:12px;margin-left:auto;margin-right:auto;left:0;right:0}@media(min-width:641px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .OfficeEditorMarginsModal .swipe-indicator{display:none}}@container (min-width: 641px){.App.is-web-component:not(.is-in-desktop-only-mode) .OfficeEditorMarginsModal .swipe-indicator{display:none}}@media(max-width:640px){.App:not(.is-in-desktop-only-mode):not(.is-web-component) .OfficeEditorMarginsModal .swipe-indicator{width:32px}}@container (max-width: 640px){.App.is-web-component:not(.is-in-desktop-only-mode) .OfficeEditorMarginsModal .swipe-indicator{width:32px}}.OfficeEditorMarginsModal{flex-direction:column}.OfficeEditorMarginsModal .modal-container{display:flex;flex-direction:column;height:auto;width:480px}.OfficeEditorMarginsModal .modal-body{padding:16px;display:flex;flex-direction:row;flex-wrap:wrap;font-size:var(--font-size-default);font-family:var(--font-family);grid-gap:16px;gap:16px}.OfficeEditorMarginsModal .modal-body .title{line-height:16px;font-weight:var(--font-weight-bold)}.OfficeEditorMarginsModal .input-container{display:flex;flex-direction:column;grid-gap:8px;gap:8px}.OfficeEditorMarginsModal .input-container .modal-label{color:var(--gray-12)}.OfficeEditorMarginsModal .input-container .ui__input__wrapper{width:auto;max-width:216px}.OfficeEditorMarginsModal .input-container .ui__input{border-color:var(--gray-6);position:relative}.OfficeEditorMarginsModal .input-container .ui__input.ui__input--focused{box-shadow:none;border-color:var(--focus-border)}.OfficeEditorMarginsModal .input-container .ui__input[\\\\:has\\\\(\\\\:disabled\\\\)]{border-color:var(--gray-5)}.OfficeEditorMarginsModal .input-container .ui__input:has(:disabled){border-color:var(--gray-5)}.OfficeEditorMarginsModal .input-container input{padding:8px 40px 8px 8px;height:32px;font-size:var(--font-size-default);width:100%}.OfficeEditorMarginsModal .input-container input[type=number]{-moz-appearance:textfield}.OfficeEditorMarginsModal .input-container input:disabled{opacity:1}.OfficeEditorMarginsModal .input-container input::-webkit-inner-spin-button,.OfficeEditorMarginsModal .input-container input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.OfficeEditorMarginsModal .flex-half{flex-basis:calc(50% - 8px)}.OfficeEditorMarginsModal .flex-full{flex-basis:100%}.OfficeEditorMarginsModal .flex-third{flex-basis:calc(33.33333% - 8px)}.OfficeEditorMarginsModal .footer{padding:16px;display:flex;justify-content:flex-end;border-top:1px solid var(--gray-5)}.OfficeEditorMarginsModal .footer button{border:none;border-radius:4px;background:var(--primary-button);min-width:59px;width:auto;padding:8px 16px;height:32px;color:var(--primary-button-text)}.OfficeEditorMarginsModal .footer button:hover{background:var(--primary-button-hover)}.OfficeEditorMarginsModal .unit-dropdown.Dropdown{height:34px}.OfficeEditorMarginsModal .unit-dropdown .Dropdown__items{width:100%}.OfficeEditorMarginsModal .unit-dropdown.Dropdown__wrapper{width:calc(50% - 8px)}\", \"\"]);\n\n// exports\nexports.locals = {\n\t\"LEFT_HEADER_WIDTH\": \"41px\",\n\t\"RIGHT_HEADER_WIDTH\": \"41px\"\n};","/**\n * @ignore\n * Maps over an array of keys and returns an object with the same keys, where each value is the result of the provided callback.\n * @param {Array<string>} keys - The array of keys to map over.\n * @param {function(string): any} fn - The function to apply to each key.\n * @returns {Object} The resulting object.\n */\nexport default (keys, fn) => {\n  return keys.reduce((acc, key) => {\n    acc[key] = fn(key);\n    return acc;\n  }, {});\n};","import React, { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport selectors from 'selectors';\nimport actions from 'actions';\nimport core from 'core';\nimport DataElements from 'constants/dataElement';\nimport Button from 'components/Button';\nimport ModalWrapper from 'components/ModalWrapper';\nimport Dropdown from 'components/Dropdown';\nimport { Input } from '@pdftron/webviewer-react-toolkit';\nimport mapObjectKeys from 'helpers/mapObjectKeys';\nimport {\n  OFFICE_EDITOR_TRANSLATION_PREFIX,\n  MARGIN_UNITS,\n  MARGIN_SIDES,\n  PIXELS_PER_INCH,\n  VERTICAL_MARGIN_LIMIT,\n  PAGE_LAYOUT_WARNING_TYPE,\n} from 'constants/officeEditor';\nimport { validateMarginInput, focusContent, convertMeasurementUnit, getMinimumColumnWidth, formatToDecimalString, showPageLayoutWarning } from 'helpers/officeEditor';\n\nimport './OfficeEditorMarginsModal.scss';\n\n// SIDES must be listed in this order for HTML inputs\nconst SIDES = [MARGIN_SIDES.LEFT, MARGIN_SIDES.RIGHT, MARGIN_SIDES.TOP, MARGIN_SIDES.BOTTOM];\n\nconst OfficeEditorMarginsModal = () => {\n  const [t] = useTranslation();\n  const dispatch = useDispatch();\n\n  const currentUnit = useSelector(selectors.getOfficeEditorUnitMeasurement);\n  const [initialUnit, setInitialUnit] = useState(currentUnit);\n  const [initialMargins, setInitialMargins] = useState({ left: 0, right: 0, top: 0, bottom: 0 });\n  const [numericMargins, setNumericMargins] = useState({ left: 0, right: 0, top: 0, bottom: 0 });\n  const [inputMargins, setInputMargins] = useState({ left: '0', right: '0', top: '0', bottom: '0' });\n  const [maxMargins, setMaxMargins] = useState({ left: 0, right: 0, top: 0, bottom: 0 });\n  const [pageWidth, setPageWidth] = useState(0);\n  const [pageHeight, setPageHeight] = useState(0);\n\n  const handleUnitChange = (unit) => dispatch(actions.setOfficeEditorUnitMeasurement(unit));\n\n  const areMarginsEqual = (a, b) => SIDES.every((side) => a[side] === b[side]);\n\n  const calculateMaxHorizontalMargins = (pageWidth, oppositeMarginWidth, unit) => {\n    const maxWidth = pageWidth - oppositeMarginWidth - getMinimumColumnWidth(unit);\n    return maxWidth;\n  };\n\n  const calculateAllMaxMargins = (pageWidth, pageHeight, margins, unit) => {\n    const maxTopAndBottom = pageHeight * VERTICAL_MARGIN_LIMIT;\n    return {\n      top: maxTopAndBottom,\n      bottom: maxTopAndBottom,\n      left: calculateMaxHorizontalMargins(pageWidth, margins.right, unit),\n      right: calculateMaxHorizontalMargins(pageWidth, margins.left, unit),\n    };\n  };\n\n  const handleBlur = (value, side, maxMargin) => {\n    const validated = validateMarginInput(value, maxMargin);\n    if (numericMargins[side] === validated && inputMargins[side] === validated.toString()) {\n      return;\n    }\n    setNumericMargins((previous) => ({ ...previous, [side]: validated }));\n    setInputMargins((previous) => ({ ...previous, [side]: validated.toString() }));\n  };\n\n  const handleChange = (value, side) => {\n    setInputMargins((previous) => ({ ...previous, [side]: value }));\n  };\n\n  const onApply = async () => {\n    if (areMarginsEqual(numericMargins, initialMargins)) {\n      closeModalAndFocus();\n      return;\n    }\n    try {\n      await core.getOfficeEditor().setSectionMargins(numericMargins, currentUnit);\n      closeModal();\n    } catch (e) {\n      console.error('Error applying margins:', e);\n      showPageLayoutWarning(dispatch, actions, PAGE_LAYOUT_WARNING_TYPE.MARGIN);\n    }\n\n  };\n\n  const closeModal = () => {\n    dispatch(actions.closeElement(DataElements.OFFICE_EDITOR_MARGINS_MODAL));\n  };\n\n  const closeModalAndFocus = () => {\n    closeModal();\n    focusContent();\n  };\n\n  const inputElements = SIDES.map((side) => ({\n    id: `${side}MarginInput`,\n    label: t(`${OFFICE_EDITOR_TRANSLATION_PREFIX}marginsModal.${side}Margin`),\n    value: inputMargins[side],\n    onChange: (e) => handleChange(e.target.value, side),\n    onBlur: (e) => handleBlur(e.target.valueAsNumber, side, maxMargins[side]),\n  }));\n\n  useEffect(() => {\n    const setInitialData = async () => {\n      const pageNumber = await core.getOfficeEditor().getEditingPageNumber();\n      const margins = await core.getOfficeEditor().getSectionMargins(currentUnit);\n      const pageWidthInInch = core.getPageWidth(pageNumber) / PIXELS_PER_INCH;\n      const pageHeightInInch = core.getPageHeight(pageNumber) / PIXELS_PER_INCH;\n      const pageWidthInCurrentUnit = convertMeasurementUnit(pageWidthInInch, MARGIN_UNITS.INCH, currentUnit);\n      const pageHeightInCurrentUnit = convertMeasurementUnit(pageHeightInInch, MARGIN_UNITS.INCH, currentUnit);\n\n      setPageWidth(pageWidthInCurrentUnit);\n      setPageHeight(pageHeightInCurrentUnit);\n      setInitialUnit(currentUnit);\n      setInitialMargins(margins);\n      setNumericMargins(margins);\n      setInputMargins(mapObjectKeys(SIDES, (side) => formatToDecimalString(margins[side])));\n      setMaxMargins(calculateAllMaxMargins(pageWidthInCurrentUnit, pageHeightInCurrentUnit, margins, currentUnit));\n    };\n    setInitialData();\n  }, []);\n\n  useEffect(() => {\n    setMaxMargins((previous) => ({\n      ...previous,\n      left: calculateMaxHorizontalMargins(pageWidth, numericMargins.right, currentUnit),\n      right: calculateMaxHorizontalMargins(pageWidth, numericMargins.left, currentUnit),\n    }));\n  }, [pageWidth, numericMargins.left, numericMargins.right]);\n\n  useEffect(() => {\n    if (currentUnit === initialUnit) {\n      return;\n    }\n    setInitialUnit(currentUnit);\n\n    const pageWidthInCurrentUnit = convertMeasurementUnit(pageWidth, initialUnit, currentUnit);\n    const pageHeightInCurrentUnit = convertMeasurementUnit(pageHeight, initialUnit, currentUnit);\n    setPageWidth(pageWidthInCurrentUnit);\n    setPageHeight(pageHeightInCurrentUnit);\n\n    const initialMarginsInCurrentUnit = mapObjectKeys(SIDES, (side) => convertMeasurementUnit(initialMargins[side], initialUnit, currentUnit));\n    const marginsInCurrentUnit = mapObjectKeys(SIDES, (side) => convertMeasurementUnit(numericMargins[side], initialUnit, currentUnit));\n    const maxMarginsInCurrentUnit = calculateAllMaxMargins(pageWidthInCurrentUnit, pageHeightInCurrentUnit, marginsInCurrentUnit, currentUnit);\n\n    // validate margins here because of rounding from conversion\n    const validatedMargins = mapObjectKeys(SIDES, (side) => validateMarginInput(marginsInCurrentUnit[side], maxMarginsInCurrentUnit[side]));\n    setInitialMargins(initialMarginsInCurrentUnit);\n    setMaxMargins(maxMarginsInCurrentUnit);\n    setNumericMargins(validatedMargins);\n    setInputMargins(mapObjectKeys(SIDES, (side) => formatToDecimalString(validatedMargins[side])));\n  }, [currentUnit, initialUnit]);\n\n  return (\n    <div className='OfficeEditorMarginsModal' data-element={DataElements.OFFICE_EDITOR_MARGINS_MODAL}>\n      <ModalWrapper\n        title={t(`${OFFICE_EDITOR_TRANSLATION_PREFIX}marginsModal.title`)}\n        closehandler={closeModalAndFocus}\n        onCloseClick={closeModalAndFocus}\n        swipeToClose\n        isOpen\n      >\n        <div className='modal-body'>\n          <div className='input-container flex-full'>\n            <label\n              id='office-editor-margin-unit-label'\n              className='modal-label'\n            >\n              {t(`${OFFICE_EDITOR_TRANSLATION_PREFIX}unitMeasurement`)}\n            </label>\n            <Dropdown\n              id='office-editor-margin-unit'\n              dataElement={DataElements.OFFICE_EDITOR_MARGIN_UNIT}\n              labelledById='office-editor-margin-unit-label'\n              className={'unit-dropdown'}\n              items={Object.values(MARGIN_UNITS)}\n              onClickItem={handleUnitChange}\n              getKey={(item) => item}\n              currentSelectionKey={currentUnit}\n              width={'auto'}\n            />\n          </div>\n\n          {inputElements.map((input) => (\n            <div key={input.id} className='input-container flex-half'>\n              <label htmlFor={input.id} className='modal-label'>{input.label}</label>\n              <Input\n                type='number'\n                id={input.id}\n                onChange={input.onChange}\n                onBlur={input.onBlur}\n                value={input.value}\n                min='0'\n                step='0.1'\n              />\n            </div>\n          ))}\n        </div>\n        <div className='footer'>\n          <Button onClick={onApply} label={t('action.apply')} />\n        </div>\n      </ModalWrapper>\n    </div>\n  );\n};\n\nexport default OfficeEditorMarginsModal;\n","import OfficeEditorMarginsModal from './OfficeEditorMarginsModal';\n\nexport default OfficeEditorMarginsModal;\n"],"sourceRoot":""}