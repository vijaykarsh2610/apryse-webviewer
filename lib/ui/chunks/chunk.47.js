(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{2022:function(e,r,t){var n=t(30),a=t(2023);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:function(e){if(!window.isApryseWebViewerWebComponent)return void document.head.appendChild(e);let r;r=document.getElementsByTagName("apryse-webviewer"),r.length||(r=function e(r,t=document){const n=[];return t.querySelectorAll(r).forEach(e=>n.push(e)),t.querySelectorAll("*").forEach(t=>{t.shadowRoot&&n.push(...e(r,t.shadowRoot))}),n}("apryse-webviewer"));const t=[];for(let n=0;n<r.length;n++){const a=r[n];if(0===n)a.shadowRoot.appendChild(e),e.onload=function(){t.length>0&&t.forEach(r=>{r.innerHTML=e.innerHTML})};else{const r=e.cloneNode(!0);a.shadowRoot.appendChild(r),t.push(r)}}},singleton:!1};n(a,o);e.exports=a.locals||{}},2023:function(e,r,t){(e.exports=t(31)(!1)).push([e.i,".FormulaOverlay{max-height:320px;width:320px;position:absolute;top:100%;left:0;background:var(--component-background);z-index:90;list-style:none;margin:0;padding:var(--padding-tiny) 0;box-shadow:0 0 3px 0 var(--box-shadow);border-radius:var(--border-radius);overflow-x:hidden;overflow-y:auto}.FormulaOverlay .formula-label{display:flex;font-weight:var(--font-weight-bold);height:28px;padding:var(--padding-tiny) var(--padding-small);line-height:20px}.FormulaOverlay .formula-overlay-list{list-style:none;padding:0;margin:0}.FormulaOverlay .formula-option{cursor:pointer;display:flex;flex-direction:column;padding:var(--padding-tiny) var(--padding-small);height:32px;line-height:20px}.FormulaOverlay .formula-option .formula-description{font-size:10px;color:var(--text-secondary);line-height:16px}.FormulaOverlay .formula-option.highlighted{background-color:var(--dropdown-item-hover);color:var(--dropdown-item-active-text);height:44px}.FormulaOverlay .formula-option.highlighted .formula-name{font-weight:var(--font-weight-bold)}",""])},2024:function(e,r,t){var n=t(30),a=t(2025);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:function(e){if(!window.isApryseWebViewerWebComponent)return void document.head.appendChild(e);let r;r=document.getElementsByTagName("apryse-webviewer"),r.length||(r=function e(r,t=document){const n=[];return t.querySelectorAll(r).forEach(e=>n.push(e)),t.querySelectorAll("*").forEach(t=>{t.shadowRoot&&n.push(...e(r,t.shadowRoot))}),n}("apryse-webviewer"));const t=[];for(let n=0;n<r.length;n++){const a=r[n];if(0===n)a.shadowRoot.appendChild(e),e.onload=function(){t.length>0&&t.forEach(r=>{r.innerHTML=e.innerHTML})};else{const r=e.cloneNode(!0);a.shadowRoot.appendChild(r),t.push(r)}}},singleton:!1};n(a,o);e.exports=a.locals||{}},2025:function(e,r,t){(e.exports=t(31)(!1)).push([e.i,".FormulaHelperOverlay .formulaHelperOverlayValue{display:inline-block;padding:var(--padding-tiny) var(--padding-small)}",""])},2026:function(e,r,t){var n=t(30),a=t(2027);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var o={insert:function(e){if(!window.isApryseWebViewerWebComponent)return void document.head.appendChild(e);let r;r=document.getElementsByTagName("apryse-webviewer"),r.length||(r=function e(r,t=document){const n=[];return t.querySelectorAll(r).forEach(e=>n.push(e)),t.querySelectorAll("*").forEach(t=>{t.shadowRoot&&n.push(...e(r,t.shadowRoot))}),n}("apryse-webviewer"));const t=[];for(let n=0;n<r.length;n++){const a=r[n];if(0===n)a.shadowRoot.appendChild(e),e.onload=function(){t.length>0&&t.forEach(r=>{r.innerHTML=e.innerHTML})};else{const r=e.cloneNode(!0);a.shadowRoot.appendChild(r),t.push(r)}}},singleton:!1};n(a,o);e.exports=a.locals||{}},2027:function(e,r,t){(e.exports=t(31)(!1)).push([e.i,".FormulaBar{display:flex;border:1px solid var(--gray-5);background-color:var(--gray-2);padding:8px;grid-gap:8px;gap:8px;border-bottom:1px solid #e0e0e0;position:relative}.FormulaBar .RangeInput{padding:6px 8px}.FormulaBar .RangeInput.focus-visible,.FormulaBar .RangeInput:focus-visible{outline:var(--focus-visible-outline)!important}.FormulaBar .Formula{display:flex;align-items:center;flex-grow:1;height:32px;position:relative;border:1px solid var(--border);border-radius:4px;background-color:var(--component-background);padding-left:30px}.FormulaBar .Formula .FormulaInput{position:relative;z-index:1;flex-grow:1;width:100%;padding:6px 8px;border:none;outline:none;font-size:14px;background-color:transparent}.FormulaBar .Formula .FormulaInput.hasFormula{color:transparent;caret-color:var(--gray-13)}.FormulaBar .Formula .FormulaOverlay{transform:translateX(38px);transform-origin:left top}.FormulaBar .Formula.readOnly{border-color:var(--lighter-border)}.FormulaBar .Formula[focus-within]{outline:var(--focus-visible-outline)!important}.FormulaBar .Formula:focus-within{outline:var(--focus-visible-outline)!important}.FormulaBar .Formula .FormulaInputMask{position:absolute;top:0;color:transparent;pointer-events:none;white-space:pre-wrap;width:100%;padding:6px 8px;font-size:14px;z-index:0}.FormulaBar .FormulaIcon{position:absolute;left:8px}.FormulaBar .FormulaIcon.readOnly{color:var(--disabled-icon)}.FormulaBar .FormulaInput{flex-grow:1;width:100%;padding:6px 8px;border:none;outline:none;background-color:transparent}",""])},2063:function(e,r,t){"use strict";t.r(r);t(19),t(12),t(13),t(8),t(14),t(10),t(9),t(11),t(16),t(15),t(20),t(18);var n=t(0),a=t.n(n),o=t(6),l=t(4),i=(t(85),t(38),t(36),t(3)),u=t.n(i),c=t(17),s=t.n(c),d=t(355),p=t(43),f=t(5),m=t(76),g=t(144),v=(t(2022),t(2024),function(e){var r,t=e.selectedFormula,n=e.labelId,o=Object(d.a)().t,l=(null==t?void 0:t.name)||"",i=(null==t||null===(r=t.parameters)||void 0===r?void 0:r.map((function(e){return o("formulas.".concat(t.name,".parameters.").concat(e.name,".name"),e.name)})))||[];return a.a.createElement("div",{className:"FormulaHelperOverlay","aria-labelledby":n},a.a.createElement("span",{className:"formulaHelperOverlayValue"},l,"(",i.join(", "),")"))});v.propTypes={selectedFormula:u.a.object,labelId:u.a.string};var h=v,b=function(e){var r=e.isOpen,t=e.options,o=e.onSelect,l=e.onClose,i=e.triggerElement,u=e.highlightedIndex,c=e.setHighlightedIndex,p=e.selectedFormula,v=e.id,b=Object(d.a)().t,y=Object(n.useRef)(null),w=Object(n.useRef)([]);Object(n.useEffect)((function(){w.current[u]&&w.current[u].scrollIntoView({behavior:"smooth",block:"nearest"})}),[u]);var E=Object(n.useCallback)((function(e){!r||null!=i&&i.contains(e.target)||l()}),[r,l,i]);return Object(g.a)(y,E),r?a.a.createElement(m.a,{dataElement:f.a.FORMULA_OVERLAY,className:"FormulaOverlay"},a.a.createElement("span",{id:"formula-overlay-label",className:"formula-label"},b("formulaBar.formulas")),!p&&a.a.createElement("ul",{ref:y,className:"formula-overlay-list",role:"listbox","aria-labelledby":"formula-overlay-label",id:v},t.map((function(e,r){return a.a.createElement("li",{key:"".concat(e.name,"-").concat(r),ref:function(e){return w.current[r]=e},className:s()("formula-option",{highlighted:u===r}),onClick:function(){return o(e)},onMouseEnter:function(){return c(r)},id:"option-".concat(r),role:"option","aria-labelledby":"formula-name-".concat(r," formula-desc-").concat(r),"aria-selected":u===r,tabIndex:0},a.a.createElement("div",{id:"formula-name-".concat(r),className:"formula-name"},e.name),u===r&&a.a.createElement("div",{id:"formula-desc-".concat(r),className:"formula-description"},b("formulas.".concat(e.name,".description"),e.description)))}))),p&&a.a.createElement(h,{selectedFormula:p,labelId:"formula-overlay-label"})):null};b.propTypes={id:u.a.string.isRequired,isOpen:u.a.bool.isRequired,options:u.a.arrayOf(u.a.shape({name:u.a.string.isRequired,description:u.a.string.isRequired})).isRequired,onSelect:u.a.func.isRequired,onClose:u.a.func.isRequired,triggerElement:u.a.instanceOf(Element),highlightedIndex:u.a.number.isRequired,setHighlightedIndex:u.a.func.isRequired,selectedFormula:u.a.shape({name:u.a.string,description:u.a.string.isRequired,parameters:u.a.arrayOf(u.a.shape({name:u.a.string}))})};var y=b,w=t(1);t(2026);function E(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,o,l,i=[],u=!0,c=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(i.push(n.value),i.length!==r);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return O(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return O(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var x=function(e){var r=e.isReadOnly,t=e.activeCellRange,o=e.cellFormula,l=e.stringCellValue,i=e.onRangeInputChange,u=e.onRangeInputKeyDown,c=Object(d.a)().t,g=o||l||"",v=E(Object(n.useState)(g),2),h=v[0],b=v[1],O=E(Object(n.useState)(!1),2),x=O[0],F=O[1],R=E(Object(n.useState)(0),2),C=R[0],j=R[1],S=E(Object(n.useState)(null),2),I=S[0],B=S[1],A=E(Object(n.useState)([]),2),k=A[0],L=A[1],M=E(Object(n.useState)([]),2),N=M[0],T=M[1],q=E(Object(n.useState)(!1),2),H=q[0],D=q[1],V=Object(n.useRef)(null),_=Object(n.useRef)(null),K=Object(n.useRef)(),U=w.a.getDocumentViewer().getSpreadsheetEditorManager();Object(n.useEffect)((function(){function e(){_.current=U.getFormulaBarProvider()}return w.a.addEventListener("spreadsheetEditorReady",e),function(){w.a.removeEventListener("spreadsheetEditorReady",e)}}),[U]),Object(n.useEffect)((function(){var e=function(e){var r,t;if(H){var n=null!==(r=null===(t=e.getFormulaInfoItems)||void 0===t?void 0:t.call(e))&&void 0!==r?r:[];L(n),j(0)}};return w.a.addEventListener("formulaSearchEvent",e),function(){w.a.removeEventListener("formulaSearchEvent",e)}}),[H]),Object(n.useEffect)((function(){var e=function(e){var r=e.getInfo();T(r);var t=r.map((function(e){return e._text})).join("");b(t)},r=function(e){var r,t;null===(r=V.current)||void 0===r||r.focus();var n=e.getSelectionPosition();null===(t=V.current)||void 0===t||t.setSelectionRange(n,n)},t=function(e){B(e.getFormulaInfo())};return w.a.addEventListener("formulaBarTextChangedEvent",e),w.a.addEventListener("formulaBarSelectionChangedEvent",r),w.a.addEventListener("formulaHelpEvent",t),function(){w.a.removeEventListener("formulaBarTextChangedEvent",e),w.a.removeEventListener("formulaBarSelectionChangedEvent",r),w.a.removeEventListener("formulaHelpEvent",t)}}),[]),Object(n.useEffect)((function(){var e=t;K.current!==e&&(b(g),K.current=e)}),[t,g]);var W=Object(n.useCallback)((function(e){_.current&&(_.current.onFormulaBarSelectFormula(e.name),_.current.onFormulaBarTextChange(e.name))}),[]),z=Object(n.useCallback)((function(){F(!1)}),[]),P=Object(n.useCallback)((function(e){var r=e.target.value;b(r),T([]),_.current&&(_.current.onFormulaBarSelectionChanged(V.current.selectionStart),_.current.onFormulaBarTextChange(r))}),[]);Object(n.useEffect)((function(){0===k.length&&!I||!H?F(!1):F(!0)}),[k,I]);var J=Object(n.useCallback)((function(){D(!0),_.current&&_.current.onFormulaBarFocus()}),[]),Y="formula-overlay-".concat(f.a.FORMULA_BAR),$=Object(n.useCallback)((function(e){if(x&&!r)switch(e.key){case"ArrowDown":return e.preventDefault(),void j((function(e){return(e+1)%k.length}));case"ArrowUp":return e.preventDefault(),void j((function(e){return(e-1+k.length)%k.length}));case"Enter":if(k[C])return void W(k[C]);break;case"Tab":if(!e.shiftKey)return e.preventDefault(),void(k[C]&&W(k[C]));break;case"Escape":return e.stopPropagation(),void z()}_.current&&(_.current.onFormulaBarSelectionChanged(V.current.selectionStart),_.current.onFormulaBarKeyDown(e))}),[x,r,k,C,W,z]);return a.a.createElement(m.a,{className:"FormulaBar",dataElement:f.a.FORMULA_BAR},a.a.createElement("input",{type:"text",className:"RangeInput",value:t,onChange:function(e){return i(e.target.value)},onKeyDown:u,"aria-label":c("formulaBar.range")}),a.a.createElement("div",{className:s()("Formula",{readOnly:r})},a.a.createElement(p.a,{glyph:"function",className:s()("FormulaIcon",{readOnly:r})}),a.a.createElement("div",{className:"FormulaInputMask"},N.map((function(e,r){return a.a.createElement("span",{key:"".concat(e.text,"-").concat(r),style:{color:e.color}},e.text)}))),a.a.createElement("input",{onFocus:J,id:f.a.FORMULA_BAR,ref:V,type:"text",role:"combobox","aria-autocomplete":"list","aria-expanded":k.length>0,"aria-controls":Y,className:s()({FormulaInput:!0,hasFormula:N.length>0}),"aria-activedescendant":x&&-1!==C?"option-".concat(C):void 0,value:h,onChange:P,onBlur:function(e){var r;!x||null!==(r=e.relatedTarget)&&void 0!==r&&r.closest("#".concat(Y))||z(),D(!1)},onKeyDown:$,readOnly:r,"aria-label":c("formulaBar.label")}),x&&!r&&a.a.createElement(y,{isOpen:x,options:k,onSelect:W,onClose:z,triggerElement:V.current,highlightedIndex:C,setHighlightedIndex:j,selectedFormula:I,id:Y})))};x.propTypes={isReadOnly:u.a.bool,activeCellRange:u.a.string,cellFormula:u.a.oneOfType([u.a.string,u.a.number]),stringCellValue:u.a.string,onRangeInputChange:u.a.func,onRangeInputKeyDown:u.a.func};var F=x;function R(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,a,o,l,i=[],u=!0,c=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(i.push(n.value),i.length!==r);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return C(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return C(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var j=window.Core.SpreadsheetEditor.SpreadsheetEditorEditMode,S=function(){var e=Object(o.e)(l.a.getActiveCellRange),r=Object(o.e)(l.a.getCellFormula),t=Object(o.e)(l.a.getStringCellValue),i=Object(o.e)(l.a.getSpreadsheetEditorEditMode)===j.VIEW_ONLY,u=R(Object(n.useState)(e),2),c=u[0],s=u[1];return Object(n.useEffect)((function(){s(e)}),[e]),a.a.createElement(F,{isReadOnly:i,activeCellRange:c,cellFormula:r,stringCellValue:t,onRangeInputChange:function(e){s(e)},onRangeInputKeyDown:function(r){if("Enter"===r.key)try{var t=w.a.getDocumentViewer().getDocument().getSpreadsheetEditorDocument(),n=w.a.getCellRange(r.target.value);t.selectCellRange(n)}catch(r){return s(e),void console.error(r)}}})};r.default=S}}]);
//# sourceMappingURL=chunk.47.js.map