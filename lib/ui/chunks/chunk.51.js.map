{"version":3,"sources":["webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss?03b6","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.scss","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss?60c7","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.scss","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/AdditionalTabsFlyout.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/TabOptionsFlyout.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/TabOptionsButton.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SheetTab/SheetTab.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcher.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/SpreadsheetSwitcherContainer.js","webpack:///./src/ui/src/components/ModularComponents/SpreadsheetEditor/SpreadsheetSwitcher/index.js"],"names":["api","content","__esModule","default","module","i","options","styleTag","window","isApryseWebViewerWebComponent","document","head","appendChild","webComponents","getElementsByTagName","length","findNestedWebComponents","tagName","root","elements","querySelectorAll","forEach","el","push","shadowRoot","clonedStyleTags","webComponent","onload","styleNode","innerHTML","cloneNode","exports","locals","AdditionalTabsFlyout","props","id","additionalTabs","tabsForReference","onClick","activeItem","dispatch","useDispatch","currentFlyout","useSelector","state","selectors","getFlyout","useLayoutEffect","noteStateFlyout","dataElement","className","items","map","item","tabLabel","name","label","title","option","disabled","isActive","Symbol","toString","sheetIndex","actions","updateFlyout","addFlyout","propTypes","PropTypes","string","arrayOf","shape","number","bool","array","func","TabOptionsFlyout","sheetId","handleClick","sheetCount","flyoutSelector","DataElements","SHEET_TAB_OPTIONS_FLYOUT","handleRenameWithFocus","useFocusHandler","e","handleDeleteWithFocus","TabOptions","onToggle","t","useTranslation","ToggleElementButton","img","toggleElement","sheet","any","isRequired","activeSheetLabel","setLabelBeingEdited","setActiveSheet","renameSheet","deleteSheet","isEditMode","validateName","noRightBorder","isReadOnlyMode","skipDeleteWarning","SheetTab","useState","inputValue","setInputValue","isInputError","setIsInputError","inputRef","useRef","useEffect","current","focus","onInputBlur","warning","message","warningKey","confirmBtnText","onConfirm","onCancel","showWarningMessage","handleInputBlurWithFocusTransfer","useFocusOnClose","component","type","classNames","ref","value","onChange","newLabel","target","isDuplicate","isEmpty","trim","onBlur","onKeyDown","key","aria-invalid","Button","role","ariaControls","ariaSelected","ariaLabel","useI18String","replace","toLowerCase","newActiveLabel","tabIndex","sheetName","text","secondaryBtnText","React","memo","SpreadsheetSwitcher","tabs","activeSheetIndex","createNewSheet","width","useWindowDimensions","breakpoint","useMemo","Math","floor","labelBeingEdited","getSpreadsheetEditorEditMode","SpreadsheetEditorEditMode","VIEW_ONLY","updateActiveTab","handleTabNameClick","index","preventDefault","stopPropagation","slice","slicedTabs","flyoutTabs","tabListRef","currentFocusIndex","useTabKeyboardNavigation","tabElements","isActiveSheetInFlyout","some","ADDITIONAL_SPREADSHEET_TABS_MENU","Icon","glyph","ERROR","NEW_SPREADSHEET_NUMBER","SpreadsheetSwitcherContainer","sheets","setSheets","setActiveSheetIndex","getSheetsFromWorkbook","workbookInstance","sheetArray","getSheetAt","onSpreadsheetEditorSheetChanged","event","core","getDocumentViewer","getDocument","getSpreadsheetEditorDocument","getWorkbook","getSheetIndex","addEventListener","removeEventListener","handleDocumentUnloaded","useCallback","useOnDocumentUnloaded","workbook","console","error","getSheet","removeSheet","ownProps","newName","isNameUnique","createSheet","oldName","currentName"],"mappings":"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","file":"chunks/chunk.51.js","sourcesContent":["var api = require(\"!../../../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../../../node_modules/css-loader/index.js!../../../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../../../node_modules/sass-loader/dist/cjs.js!./SheetTab.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                function findNestedWebComponents(tagName, root = document) {\n                  const elements = [];\n\n                  // Check direct children\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\n\n                  // Check shadow DOMs\n                  root.querySelectorAll('*').forEach(el => {\n                    if (el.shadowRoot) {\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\n                    }\n                  });\n\n                  return elements;\n                }\n                if (!window.isApryseWebViewerWebComponent) {\n                  document.head.appendChild(styleTag);\n                  return;\n                }\n\n                let webComponents;\n                // First we see if the webcomponent is at the document level\n                webComponents = document.getElementsByTagName('apryse-webviewer');\n                // If not, we check have to check if it is nested in another webcomponent\n                if (!webComponents.length) {\n                  webComponents = findNestedWebComponents('apryse-webviewer');\n                }\n                // Now we append the style tag to each webcomponent\n                const clonedStyleTags = [];\n                for (let i = 0; i < webComponents.length; i++) {\n                  const webComponent = webComponents[i];\n                  if (i === 0) {\n                    webComponent.shadowRoot.appendChild(styleTag);\n                    styleTag.onload = function () {\n                      if (clonedStyleTags.length > 0) {\n                        clonedStyleTags.forEach((styleNode) => {\n                          // eslint-disable-next-line no-unsanitized/property\n                          styleNode.innerHTML = styleTag.innerHTML;\n                        });\n                      }\n                    };\n                  } else {\n                    const styleNode = styleTag.cloneNode(true);\n                    webComponent.shadowRoot.appendChild(styleNode);\n                    clonedStyleTags.push(styleNode);\n                  }\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sheet-tab{cursor:pointer;border-bottom:none;border-top-right-radius:4px;border-top-left-radius:4px;min-width:170px;height:40px;position:relative;border-right:1px solid transparent}.sheet-tab:hover{background:var(--faded-component-background)}.sheet-tab.no-left-border .tab-body{border-right:1px solid transparent}.sheet-tab .tab-body{height:24px;display:flex;padding:0 8px;width:100%;position:absolute;top:50%;transform:translateY(-50%);border-right:1px solid var(--border)}.sheet-tab .tab-body.input-mode{padding-left:5px;padding-right:6px}.sheet-tab .tab-body .sheet-label{width:calc(100% - 24px);text-align:left;justify-content:left;height:24px}.sheet-tab .tab-body .sheet-label span{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.sheet-tab .tab-body .sheet-input{max-width:100%}.sheet-tab .tab-body input.input-error{border-color:red}.sheet-tab.active{border:1px solid var(--border);border-bottom:none;background:var(--gray-0)}.sheet-tab.active .tab-body{border-right:1px solid transparent}.sheet-tab .sheet-options .ToggleElementButton button{width:24px;height:24px;min-width:24px}.sheet-tab .sheet-options .ToggleElementButton button .Icon{width:16px;height:14px}.sheet-tab .sheet-options .more-options-icon{height:24px;width:24px}.sheet-tab .sheet-options .more-options-icon .Icon{width:16px;height:16px}\", \"\"]);\n\n// exports\n","var api = require(\"!../../../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/postcss-loader/src/index.js??postcss!../../../../../../../node_modules/sass-loader/dist/cjs.js!./SpreadsheetSwitcher.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = function (styleTag) {\n                function findNestedWebComponents(tagName, root = document) {\n                  const elements = [];\n\n                  // Check direct children\n                  root.querySelectorAll(tagName).forEach(el => elements.push(el));\n\n                  // Check shadow DOMs\n                  root.querySelectorAll('*').forEach(el => {\n                    if (el.shadowRoot) {\n                      elements.push(...findNestedWebComponents(tagName, el.shadowRoot));\n                    }\n                  });\n\n                  return elements;\n                }\n                if (!window.isApryseWebViewerWebComponent) {\n                  document.head.appendChild(styleTag);\n                  return;\n                }\n\n                let webComponents;\n                // First we see if the webcomponent is at the document level\n                webComponents = document.getElementsByTagName('apryse-webviewer');\n                // If not, we check have to check if it is nested in another webcomponent\n                if (!webComponents.length) {\n                  webComponents = findNestedWebComponents('apryse-webviewer');\n                }\n                // Now we append the style tag to each webcomponent\n                const clonedStyleTags = [];\n                for (let i = 0; i < webComponents.length; i++) {\n                  const webComponent = webComponents[i];\n                  if (i === 0) {\n                    webComponent.shadowRoot.appendChild(styleTag);\n                    styleTag.onload = function () {\n                      if (clonedStyleTags.length > 0) {\n                        clonedStyleTags.forEach((styleNode) => {\n                          // eslint-disable-next-line no-unsanitized/property\n                          styleNode.innerHTML = styleTag.innerHTML;\n                        });\n                      }\n                    };\n                  } else {\n                    const styleNode = styleTag.cloneNode(true);\n                    webComponent.shadowRoot.appendChild(styleNode);\n                    clonedStyleTags.push(styleNode);\n                  }\n                }\n              };\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","exports = module.exports = require(\"../../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".Flyout[\\\\:has\\\\(.SheetOptionsFlyout\\\\)]{z-index:130}.Flyout:has(.SheetOptionsFlyout){z-index:130}.SpreadsheetSwitcher{padding:0}.GenericFileTab{display:flex;padding-left:4px;padding-top:4px}.GenericFileTab .dropdown-menu{border:1px solid var(--border);margin-top:3px;margin-left:5px}.GenericFileTab .dropdown-menu .Icon{position:absolute}.GenericFileTab .add-sheet-tab{margin-top:3px;margin-left:5px}.GenericFileTab .add-sheet-tab .Icon{width:14px;height:14px}\", \"\"]);\n\n// exports\n","import { useLayoutEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport selectors from 'selectors';\nimport actions from 'actions';\nimport PropTypes from 'prop-types';\n\nconst AdditionalTabsFlyout = (props) => {\n  const {\n    id = '',\n    additionalTabs,\n    tabsForReference,\n    onClick,\n    activeItem,\n  } = props;\n  const dispatch = useDispatch();\n\n  const currentFlyout = useSelector((state) => selectors.getFlyout(state, id));\n\n  useLayoutEffect(() => {\n    const noteStateFlyout = {\n      dataElement: id,\n      className: 'AdditionalTabsFlyout',\n      items: additionalTabs.map((item) => {\n        const tabLabel = item.name;\n\n        return {\n          label: tabLabel,\n          title: tabLabel,\n          option: tabLabel,\n          disabled: item.disabled,\n          isActive: tabLabel === activeItem,\n          dataElement: Symbol(tabLabel).toString(),\n          onClick: () => onClick(tabLabel, item.sheetIndex),\n        };\n      })\n    };\n    if (!currentFlyout) {\n      dispatch(actions.addFlyout(noteStateFlyout));\n    } else {\n      dispatch(actions.updateFlyout(noteStateFlyout.dataElement, noteStateFlyout));\n    }\n  }, [tabsForReference, activeItem]);\n\n  return null;\n};\n\nAdditionalTabsFlyout.propTypes = {\n  id: PropTypes.string,\n  additionalTabs: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string,\n    sheetIndex: PropTypes.number,\n    disabled: PropTypes.bool,\n  })),\n  tabsForReference: PropTypes.array,\n  onClick: PropTypes.func,\n  activeItem: PropTypes.string,\n};\n\nexport default AdditionalTabsFlyout;\n\n\n","import { useLayoutEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport DataElements from 'src/constants/dataElement';\nimport actions from 'actions';\nimport selectors from 'selectors';\nimport useFocusHandler from 'hooks/useFocusHandler';\n\nconst TabOptionsFlyout = (props) => {\n  const {\n    sheetId,\n    handleClick,\n    sheetCount,\n    disabled,\n  } = props;\n\n  const dispatch = useDispatch();\n  const flyoutSelector = `${DataElements.SHEET_TAB_OPTIONS_FLYOUT}-${sheetId}`;\n  const currentFlyout = useSelector((state) => selectors.getFlyout(state, flyoutSelector));\n\n  const handleRenameWithFocus = useFocusHandler((e) => handleClick('Rename', e));\n  const handleDeleteWithFocus = useFocusHandler((e) => handleClick('Delete', e));\n\n  useLayoutEffect(() => {\n    const noteStateFlyout = {\n      dataElement: flyoutSelector,\n      className: 'TabOptionsFlyout',\n      items: [\n        {\n          label: 'action.rename',\n          title: 'action.rename',\n          option: 'Rename',\n          dataElement: 'sheetTabRenameOption',\n          onClick: handleRenameWithFocus,\n        },\n        {\n          label: 'action.delete',\n          title: 'action.delete',\n          option: 'Delete',\n          dataElement: 'sheetTabDeleteOption',\n          onClick: handleDeleteWithFocus,\n          disabled: (sheetCount === 1 || disabled),\n        }\n      ]\n    };\n\n    if (!currentFlyout) {\n      dispatch(actions.addFlyout(noteStateFlyout));\n    } else {\n      dispatch(actions.updateFlyout(noteStateFlyout.dataElement, noteStateFlyout));\n    }\n  }, [sheetCount, disabled, handleClick]);\n\n  return null;\n};\n\nTabOptionsFlyout.propTypes  = {\n  sheetId: PropTypes.string,\n  handleClick: PropTypes.func,\n  sheetCount: PropTypes.number,\n  disabled: PropTypes.bool,\n};\n\nexport default TabOptionsFlyout;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ToggleElementButton from 'components/ModularComponents/ToggleElementButton';\nimport { useTranslation } from 'react-i18next';\nimport SheetOptionsFlyout from './TabOptionsFlyout';\nimport DataElements from 'src/constants/dataElement';\n\n\nconst TabOptions = (props) => {\n  const {\n    handleClick = () => { },\n    id,\n    onToggle,\n    label,\n    disabled,\n    sheetCount,\n  } = props;\n\n  const [t] = useTranslation();\n  const icon = 'icon-tools-more-vertical';\n\n  return (\n    <>\n      <ToggleElementButton\n        dataElement={`options-${id}`}\n        title={`${t('option.searchPanel.moreOptions')} ${label}`}\n        img={icon}\n        onToggle={(isActive) => {\n          if (isActive) {\n            onToggle(label);\n          }\n        }}\n        disabled={disabled}\n        toggleElement={`${DataElements.SHEET_TAB_OPTIONS_FLYOUT}-${id}`}\n      />\n      <SheetOptionsFlyout\n        sheetId={id}\n        sheetCount={sheetCount}\n        handleClick={(option) => handleClick(id, label, option)}\n        disabled={disabled}\n      />\n    </>\n  );\n};\n\nTabOptions.propTypes = {\n  id: PropTypes.string,\n  label: PropTypes.string,\n  onToggle: PropTypes.func,\n  handleClick: PropTypes.func,\n  disabled: PropTypes.bool,\n  sheetCount: PropTypes.number,\n};\n\nexport default TabOptions;\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useDispatch } from 'react-redux';\nimport actions from 'actions';\nimport PropTypes from 'prop-types';\nimport Button from 'components/Button';\nimport classNames from 'classnames';\nimport TabOptions from '../TabOptionsButton';\nimport { useTranslation } from 'react-i18next';\nimport './SheetTab.scss';\nimport useFocusOnClose from 'hooks/useFocusOnClose';\n\nconst propTypes = {\n  sheet: PropTypes.any.isRequired,\n  sheetCount: PropTypes.number,\n  activeSheetLabel: PropTypes.string.isRequired,\n  setLabelBeingEdited: PropTypes.func.isRequired,\n  setActiveSheet: PropTypes.func.isRequired,\n  renameSheet: PropTypes.func.isRequired,\n  deleteSheet: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  isEditMode: PropTypes.bool.isRequired,\n  validateName: PropTypes.func,\n  noRightBorder: PropTypes.bool,\n  isReadOnlyMode: PropTypes.bool,\n  skipDeleteWarning: PropTypes.bool,\n};\n\nconst SheetTab = ({\n  sheet,\n  activeSheetLabel,\n  onClick,\n  sheetCount,\n  setLabelBeingEdited,\n  setActiveSheet,\n  isEditMode,\n  noRightBorder,\n  validateName,\n  isReadOnlyMode,\n  deleteSheet,\n  renameSheet,\n  skipDeleteWarning,\n}) => {\n  const { sheetIndex, name: label, disabled } = sheet;\n\n  const isActive = label === activeSheetLabel;\n\n  const [inputValue, setInputValue] = useState('');\n  const [isInputError, setIsInputError] = useState(false);\n  const { t } = useTranslation();\n  const inputRef = useRef();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (inputValue && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [inputValue]);\n\n  const onInputChange = (e) => {\n    const newLabel = e.target.value;\n    const isDuplicate = validateName(label, newLabel);\n    const isEmpty = newLabel.trim() === '';\n\n    setIsInputError(isDuplicate || isEmpty);\n    setInputValue(newLabel);\n  };\n\n  const updateActiveTab = (newActiveLabel, tabIndex) => {\n    setLabelBeingEdited(null);\n    setIsInputError(false);\n    setActiveSheet(newActiveLabel, tabIndex);\n  };\n\n  const startLabelEditingMode = (text) => {\n    setInputValue(text);\n    setIsInputError(false);\n    setLabelBeingEdited(text);\n  };\n\n  const inputErrorWarning = () => {\n    const isEmpty = inputValue === '';\n    const warningKey = isEmpty ? 'warning.sheetTabRenameIssueTwo' : 'warning.sheetTabRenameIssueOne';\n    const warning = {\n      message: t(`${warningKey}.message`),\n      title: t(`${warningKey}.title`),\n      confirmBtnText: t('action.ok'),\n      onConfirm: () => inputRef.current.focus(),\n      onCancel: () => {\n        setLabelBeingEdited(false);\n        setIsInputError(false);\n        setInputValue(label);\n      }\n    };\n    dispatch(actions.showWarningMessage(warning));\n  };\n\n  const onInputBlur = () => {\n    if (isInputError) {\n      inputErrorWarning();\n      return;\n    }\n    renameSheet(label, inputValue);\n    setLabelBeingEdited(null);\n    setIsInputError(false);\n    setInputValue('');\n  };\n\n  const handleInputBlurWithFocusTransfer = useFocusOnClose(onInputBlur, 'addTabButton');\n\n  const onKeyDown = (e) => {\n    if (e.key === 'Enter' && !isInputError) {\n      handleInputBlurWithFocusTransfer();\n    }\n  };\n\n  const handleTabOptionSelection = (id, sheetName, option) => {\n    if (option === 'Rename') {\n      startLabelEditingMode(sheetName);\n    } else if (option === 'Delete') {\n      if (skipDeleteWarning) {\n        return deleteSheet(label);\n      }\n      const message = t('warning.sheetTabDeleteMessage.message');\n      const title = t('warning.sheetTabDeleteMessage.title');\n      const confirmBtnText = t('action.ok');\n      const secondaryBtnText = t('action.cancel');\n      const warning = {\n        message,\n        title,\n        confirmBtnText,\n        secondaryBtnText,\n        onConfirm: () => {\n          deleteSheet(label);\n        },\n      };\n      dispatch(actions.showWarningMessage(warning));\n    }\n  };\n\n  let component = null;\n  if (isEditMode) {\n    component = (\n      <input type='text'\n        className={classNames('sheet-input', { 'input-error': isInputError })}\n        ref={inputRef}\n        value={inputValue}\n        onChange={onInputChange}\n        onBlur={onInputBlur}\n        onKeyDown={onKeyDown}\n        aria-invalid={isInputError}\n      />\n    );\n  } else {\n    component = (\n      <>\n        <Button\n          role='tab'\n          ariaControls={'document-container'}\n          ariaSelected={isActive}\n          ariaLabel={label}\n          className={'sheet-label'}\n          onClick={(e) => onClick(e, label, sheetIndex)}\n          title={label}\n          label={label}\n          useI18String={false}\n          disabled={disabled}\n        />\n        <div className='sheet-options'>\n          <TabOptions id={label?.replace(/\\s+/g, '-').toLowerCase()}\n            label={label}\n            sheetCount={sheetCount}\n            onToggle={(name) => updateActiveTab(name, sheetIndex)}\n            handleClick={handleTabOptionSelection}\n            disabled={isReadOnlyMode}\n          />\n        </div>\n      </>\n    );\n  }\n\n  return (<div className={classNames({\n    'active': isActive,\n    'no-left-border': noRightBorder,\n    'disabled': disabled,\n  }, 'sheet-tab')}\n  >\n    <div className={classNames({ 'input-mode': isEditMode },'tab-body')}>\n      {component}\n    </div>\n  </div>);\n\n};\n\nSheetTab.propTypes = propTypes;\n\nexport default React.memo(SheetTab);","import React, { useState, useMemo, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport useWindowDimensions from 'helpers/useWindowsDimensions';\nimport Button from 'components/Button';\nimport ToggleElementButton from 'components/ModularComponents/ToggleElementButton';\nimport Icon from 'components/Icon';\nimport DataElements from 'constants/dataElement';\nimport { SpreadsheetEditorEditMode } from 'constants/spreadsheetEditor';\nimport AdditionalTabsFlyout from './AdditionalTabsFlyout';\nimport SheetTab from './SheetTab/SheetTab';\nimport './SpreadsheetSwitcher.scss';\nimport PropTypes from 'prop-types';\nimport selectors from 'selectors';\nimport useTabKeyboardNavigation from 'hooks/useArrowNavigation';\n\nconst SpreadsheetSwitcher = (props) => {\n  const {\n    tabs = [],\n    activeSheetIndex = 0,\n    setActiveSheet,\n    createNewSheet,\n    deleteSheet,\n    renameSheet,\n    validateName,\n    skipDeleteWarning = false,\n  } = props;\n  const activeSheetLabel = tabs[activeSheetIndex]?.name || '';\n  const { width } = useWindowDimensions();\n  const breakpoint = useMemo(() => Math.floor((width - 80) / 170), [width]);\n  const { t } = useTranslation();\n  const [labelBeingEdited, setLabelBeingEdited] = useState('');\n\n  const spreadsheetEditorEditMode = useSelector(selectors.getSpreadsheetEditorEditMode);\n  const isReadOnlyMode = spreadsheetEditorEditMode === SpreadsheetEditorEditMode.VIEW_ONLY;\n\n  const updateActiveTab = (newActiveLabel, tabIndex) => {\n    setLabelBeingEdited(null);\n    setActiveSheet(newActiveLabel, tabIndex);\n  };\n\n  const handleTabNameClick = (e, label, index) => {\n    e.preventDefault();\n    e.stopPropagation();\n    updateActiveTab(label, index);\n  };\n\n  // Break the sheet tabs into two, one regular view, and one into flyout\n  const [slicedTabs, flyoutTabs] = useMemo(() => {\n    return [tabs.slice(0, breakpoint), tabs.slice(breakpoint)];\n  }, [tabs, breakpoint]);\n\n  const tabListRef = useRef();\n  const {\n    currentFocusIndex,\n  } = useTabKeyboardNavigation(tabListRef, [slicedTabs, labelBeingEdited]);\n\n  const tabElements = slicedTabs.map((item, i) => (\n    <SheetTab\n      key={item.sheetIndex}\n      sheet={item}\n      sheetCount={tabs.length}\n      activeSheetLabel={activeSheetLabel}\n      onClick={handleTabNameClick}\n      isEditMode={labelBeingEdited === item.name}\n      setLabelBeingEdited={setLabelBeingEdited}\n      setActiveSheet={setActiveSheet}\n      deleteSheet={deleteSheet}\n      renameSheet={renameSheet}\n      noRightBorder={tabs[item.sheetIndex + 1] && tabs[item.sheetIndex + 1].name === activeSheetLabel}\n      validateName={validateName}\n      isReadOnlyMode={isReadOnlyMode}\n      skipDeleteWarning={skipDeleteWarning}\n      tabIndex={currentFocusIndex === i ? 0 : -1}\n    />\n  ));\n\n  const isActiveSheetInFlyout = useMemo(() => {\n    return flyoutTabs.some((item) => item.name === activeSheetLabel);\n  }, [flyoutTabs, activeSheetLabel]);\n\n  return (\n    <div className=\"SpreadsheetSwitcher ModularHeader BottomHeader stroke start\">\n      <div className={'GenericFileTab'} role='tablist' ref={tabListRef}>\n        {tabElements}\n        {\n          (flyoutTabs?.length > 0) ?\n            (\n              <ToggleElementButton\n                className=\"dropdown-menu tab-dropdown-button\"\n                dataElement=\"tabTrigger\"\n                title={t('message.showMore')}\n                toggleElement={DataElements.ADDITIONAL_SPREADSHEET_TABS_MENU}\n                label={flyoutTabs.length.toString()}\n              >\n                {(isActiveSheetInFlyout) && (<Icon glyph=\"icon-active-indicator\"></Icon>)}\n              </ToggleElementButton>\n            ) : null\n        }\n        <Button\n          className=\"add-sheet-tab\"\n          title=\"action.addSheet\"\n          img=\"icon-menu-add\"\n          onClick={createNewSheet}\n          dataElement={'addTabButton'}\n          label={''}\n          ariaLabel={t('action.addSheet')}\n          disabled={isReadOnlyMode}\n        />\n        {flyoutTabs?.length > 0 &&\n          (\n            <AdditionalTabsFlyout\n              id={DataElements.ADDITIONAL_SPREADSHEET_TABS_MENU}\n              additionalTabs={flyoutTabs}\n              tabsForReference={tabs}\n              onClick={updateActiveTab}\n              activeItem={activeSheetLabel}\n            />\n          )\n        }\n      </div>\n    </div>\n  );\n};\n\nSpreadsheetSwitcher.propTypes = {\n  tabs: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string,\n    sheetIndex: PropTypes.number,\n    disabled: PropTypes.bool,\n  })),\n  activeSheetIndex: PropTypes.number,\n  setActiveSheet: PropTypes.func,\n  createNewSheet: PropTypes.func,\n  deleteSheet: PropTypes.func,\n  renameSheet: PropTypes.func,\n  skipDeleteWarning: PropTypes.bool,\n  validateName: PropTypes.func,\n};\n\nexport default SpreadsheetSwitcher;","import React, { useState, useEffect, useCallback } from 'react';\nimport core from 'core';\nimport SpreadsheetSwitcher from './SpreadsheetSwitcher';\nimport useOnDocumentUnloaded from 'hooks/useOnDocumentUnloaded';\nimport { useTranslation } from 'react-i18next';\nimport useFocusOnClose from 'src/hooks/useFocusOnClose';\n\nconst ERROR = 'SpreadsheetEditorDocument is not loaded';\nlet NEW_SPREADSHEET_NUMBER = 2;\n\nfunction SpreadsheetSwitcherContainer(props) {\n  const { t } = useTranslation();\n  const [sheets, setSheets] = useState([]);\n  const [activeSheetIndex, setActiveSheetIndex] = useState(0);\n\n  const getSheetsFromWorkbook = (workbookInstance) => {\n    let sheetCount = workbookInstance.sheetCount;\n    const sheetArray = [];\n    for (let i = 0; i < sheetCount; i++) {\n      const sheet = workbookInstance.getSheetAt(i);\n      sheetArray.push({ name: sheet.name, sheetIndex: i });\n    }\n    return sheetArray;\n  };\n\n  useEffect(() => {\n    const onSpreadsheetEditorSheetChanged = (event) => {\n      const documentViewer = core.getDocumentViewer();\n      const doc = documentViewer.getDocument().getSpreadsheetEditorDocument();\n      const workbookInstance = doc.getWorkbook();\n      setSheets(getSheetsFromWorkbook(workbookInstance));\n      setActiveSheetIndex(event.getSheetIndex());\n    };\n\n    core.addEventListener('activeSheetChanged', onSpreadsheetEditorSheetChanged);\n    return () => {\n      core.removeEventListener('activeSheetChanged', onSpreadsheetEditorSheetChanged);\n    };\n  }, []);\n\n  const handleDocumentUnloaded = useCallback(() => {\n    setSheets([]);\n    setActiveSheetIndex(0);\n  }, []);\n  useOnDocumentUnloaded(handleDocumentUnloaded);\n\n  const setActiveSheet = (name, index) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    if (workbook.getSheetAt(index)) {\n      workbook.setActiveSheet(index);\n      setActiveSheetIndex(index);\n    }\n  };\n\n  const createNewSheet = () => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    let newName = t('spreadsheetEditor.blankSheet');\n    let isNameUnique = !workbook.getSheet(newName);\n    while (!isNameUnique) {\n      newName = `${t('spreadsheetEditor.blankSheet')} ${NEW_SPREADSHEET_NUMBER++}`;\n      isNameUnique = !workbook.getSheet(newName);\n    }\n    workbook.createSheet(newName);\n  };\n\n  const deleteSheet = useFocusOnClose((name) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    if (workbook.getSheet(name)) {\n      workbook.removeSheet(name);\n    }\n    setSheets(getSheetsFromWorkbook(workbook));\n  }, 'addTabButton');\n\n  const renameSheet = (oldName, newName) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      return console.error(ERROR);\n    }\n\n    const sheet = workbook.getSheet(oldName);\n    if (sheet) {\n      sheet.name = newName;\n    }\n    setSheets(getSheetsFromWorkbook(workbook));\n  };\n\n  const validateName = (currentName, newName) => {\n    const workbook = core.getDocument()?.getSpreadsheetEditorDocument()?.getWorkbook();\n    if (!workbook) {\n      console.error(ERROR);\n      return false;\n    }\n\n    if (currentName === newName) {\n      return false;\n    }\n    return !!workbook.getSheet(newName);\n  };\n\n  const ownProps = {\n    ...props,\n    tabs: sheets,\n    activeSheetIndex,\n    setActiveSheet,\n    createNewSheet,\n    deleteSheet,\n    renameSheet,\n    validateName,\n  };\n\n  return (<SpreadsheetSwitcher {...ownProps} />);\n}\n\nSpreadsheetSwitcherContainer.propTypes = { };\n\nexport default SpreadsheetSwitcherContainer;","import SpreadsheetSwitcherContainer from './SpreadsheetSwitcherContainer';\n\nexport default SpreadsheetSwitcherContainer;"],"sourceRoot":""}